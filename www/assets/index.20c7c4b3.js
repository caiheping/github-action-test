var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,i=(e,t)=>{for(var a in t||(t={}))o.call(t,a)&&s(e,a,t[a]);if(l)for(var a of l(t))n.call(t,a)&&s(e,a,t[a]);return e};import{H as r,M as c,m as d,a as u}from"./index.b4c50d36.js";import{_ as p,g as m,s as f}from"./index.b7715d33.js";import{u as y}from"./useDrawer.8fe26ed9.js";import{d as v,r as g,a as b,c as h,f as C,a3 as w,j as T,n as _,t as S,a2 as k,l as O,m as x,v as R,q as j,a0 as F,Q as K,F as L,U,O as z,A as I}from"./ant-design-vue.10f2c163.js";const P=[{title:"标题",dataIndex:"noticeTitle",key:"noticeTitle",align:"center"},{title:"类型",dataIndex:"noticeType",key:"noticeType",align:"center",slots:{customRender:"noticeType"}},{title:"内容",dataIndex:"noticeContent",key:"noticeContent",align:"center"},{title:"状态",dataIndex:"status",key:"status",align:"center",slots:{customRender:"status"}},{title:"创建者",dataIndex:"createdBy",key:"createdBy",align:"center"},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",align:"center"},{title:"操作",key:"action",align:"center",slots:{customRender:"action"}}];var q=v({components:{FormSearch:p},setup(){const e=g([]),l=g([]),o=b([{type:"input",label:"标题",name:"noticeTitle",value:"",placeholder:"请输入标题"},{type:"select",label:"类型",name:"noticeType",value:void 0,placeholder:"请选择类型",normalizer:{value:"dictValue",label:"dictLabel"},options:l},{type:"select",label:"状态",name:"status",value:void 0,placeholder:"请选择角色状态",normalizer:{value:"dictValue",label:"dictLabel"},options:e}]),n=b({pageNum:1,pageSize:10,noticeTitle:"",noticeType:"",status:""}),s=g([]),d=g({total:0,current:1,pageSize:10,showSizeChanger:!0,showTotal:e=>`共 ${e} 条`}),u=b({selectedRowKeys:[]}),p=h((()=>u.selectedRowKeys.length>0)),v=e=>{(function(e={}){return r("/admin/system/notice",c.get,e,!1)})(e).then((e=>{console.log(e),s.value=e.data.rows,d.value.total=e.data.count,u.selectedRowKeys=[]}))},S=g(),k=b({id:void 0,noticeTitle:void 0,noticeType:void 0,status:"1",noticeContent:void 0}),{open:O,drawerTitle:x}=y();console.log(O);return C((async()=>{e.value=await m("sys_normal_disable"),l.value=await m("sys_notice_type"),v(n)})),R=i({queryParams:n,formFields:o,handleQuery:e=>{d.value.current=1,n.pageNum=d.value.current,n.noticeTitle=e.noticeTitle,n.noticeType=e.noticeType,n.status=e.status,v(n)},userList:s,columns:P,pagination:d,handleTableChange:e=>{d.value=e,n.pageNum=d.value.current,n.pageSize=d.value.pageSize,v(n)},selectDictLabel:f,statusOptions:e,typeOptions:l},w(u)),t(R,a({hasSelected:p,onSelectChange:e=>{console.log("selectedRowKeys changed: ",e),u.selectedRowKeys=e},open:O,drawerTitle:x,formState:k,labelCol:{span:4},wrapperCol:{span:18},rules:{noticeTitle:[{required:!0,message:"标题不能为空",trigger:"blur"}],noticeType:[{required:!0,message:"类型不能为空",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"change"}]},formRef:S,handleClose:()=>{k.id=void 0,S.value.resetFields(),console.log(S),O.value=!1},handleSubmit:()=>{console.log(k),S.value.validate().then((()=>{var e;k.id?(e=k,r("/admin/system/notice/"+e.id,c.put,e)).then((e=>{T.success(e.message),v(n),k.id=void 0,S.value.resetFields(),O.value=!1})):function(e={}){return r("/admin/system/notice",c.post,e)}(k).then((e=>{T.success(e.message),v(n),k.id=void 0,S.value.resetFields(),O.value=!1}))})).catch((e=>{console.log("error",e)}))},confirm:e=>{const t=e.id||u.selectedRowKeys;var a;(a=t,r("/admin/system/notice/"+a,c.del)).then((()=>{v(n),T.success("删除成功")}))},cancel:e=>{console.log(e),T.success("取消删除")},handleAdd:()=>{O.value=!0,x.value="添加消息"},handleUpdate:e=>{var t;(t=e.id,r("/admin/system/notice/"+t,c.get,{},!1)).then((e=>{O.value=!0,x.value="修改消息",_((()=>{Object.keys(k).forEach((t=>{k[t]=e.data[t]}))}))}))}}));var R},computed:i({},d(u,["loading"]))});const A={class:"p-4"},D={class:"mb-3"},Q=z("新增"),N=z(" 删除 "),V=z(" 修改 "),B=z(" 删除 "),E=z(" 确认 "),H=z("取消");q.render=function(e,t,a,l,o,n){const s=S("form-search"),i=S("a-button"),r=S("a-col"),c=S("a-popconfirm"),d=S("a-row"),u=S("a-table"),p=S("a-input"),m=S("a-form-item"),f=S("a-select-option"),y=S("a-select"),v=S("a-radio-group"),g=S("a-textarea"),b=S("a-form"),h=S("a-drawer"),C=k("has-permi");return O(),x("div",A,[R("div",D,[R(s,{formFields:e.formFields,onSearch:e.handleQuery,onReset:e.handleQuery},null,8,["formFields","onSearch","onReset"])]),R(d,{gutter:10,class:"mb-2"},{default:j((()=>[F(R(r,null,{default:j((()=>[R(i,{color:"success",onClick:e.handleAdd},{default:j((()=>[Q])),_:1},8,["onClick"])])),_:1},512),[[C,["system:notice:add"]]]),F(R(r,null,{default:j((()=>[R(c,{title:"确定要删除选中数据吗？","ok-text":"确定","cancel-text":"取消",onConfirm:e.confirm,onCancel:e.cancel},{default:j((()=>[R(i,{disabled:!e.hasSelected,color:"error"},{default:j((()=>[N])),_:1},8,["disabled"])])),_:1},8,["onConfirm","onCancel"])])),_:1},512),[[C,["system:notice:delete"]]])])),_:1}),R(u,{loading:e.loading,rowKey:"id","row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},columns:e.columns,"data-source":e.userList,pagination:e.pagination,onChange:e.handleTableChange},{status:j((({record:t})=>[R("span",null,K(e.selectDictLabel(e.statusOptions,t.status)),1)])),noticeType:j((({record:t})=>[R("span",null,K(e.selectDictLabel(e.typeOptions,t.noticeType)),1)])),action:j((({record:t})=>[R("span",null,[F(R(i,{type:"link",color:"success",class:"mr-3",onClick:a=>e.handleUpdate(t)},{default:j((()=>[V])),_:2},1032,["onClick"]),[[C,["system:notice:update"]]]),R(c,{title:"确定要删除该数据吗？","ok-text":"确定","cancel-text":"取消",onConfirm:a=>e.confirm(t),onCancel:e.cancel},{default:j((()=>[F(R(i,{type:"link",color:"error"},{default:j((()=>[B])),_:1},512),[[C,["system:notice:delete"]]])])),_:2},1032,["onConfirm","onCancel"])])])),_:1},8,["loading","row-selection","columns","data-source","pagination","onChange"]),R(h,{width:"600px",title:e.drawerTitle,placement:"right",visible:e.open,"onUpdate:visible":t[5]||(t[5]=t=>e.open=t),maskClosable:!1,onClose:e.handleClose},{default:j((()=>[e.open?(O(),x(b,{key:0,ref:"formRef",model:e.formState,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol},{default:j((()=>[R(d,null,{default:j((()=>[R(r,{span:24},{default:j((()=>[R(m,{label:"标题",name:"noticeTitle"},{default:j((()=>[R(p,{value:e.formState.noticeTitle,"onUpdate:value":t[1]||(t[1]=t=>e.formState.noticeTitle=t),placeholder:"请输入标题"},null,8,["value"])])),_:1})])),_:1}),R(r,{span:24},{default:j((()=>[R(m,{label:"类型",name:"noticeType"},{default:j((()=>[R(y,{value:e.formState.noticeType,"onUpdate:value":t[2]||(t[2]=t=>e.formState.noticeType=t),placeholder:"请输入类型"},{default:j((()=>[(O(!0),x(L,null,U(e.typeOptions,(e=>(O(),x(f,{key:e.id,value:e.dictValue},{default:j((()=>[z(K(e.dictLabel),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1})])),_:1}),R(r,{span:24},{default:j((()=>[R(m,{label:"状态",name:"status"},{default:j((()=>[R(v,{value:e.formState.status,"onUpdate:value":t[3]||(t[3]=t=>e.formState.status=t),name:"menuType",options:[{label:"正常",value:"1"},{label:"停用",value:"0"}]},null,8,["value"])])),_:1})])),_:1}),R(r,{span:24},{default:j((()=>[R(m,{label:"内容",name:"noticeContent"},{default:j((()=>[R(g,{rows:3,value:e.formState.noticeContent,"onUpdate:value":t[4]||(t[4]=t=>e.formState.noticeContent=t),placeholder:"请输入内容"},null,8,["value"])])),_:1})])),_:1}),R(r,{span:24},{default:j((()=>[R(m,null,{default:j((()=>[R(i,{type:"primary",class:"mr-3",onClick:e.handleSubmit},{default:j((()=>[E])),_:1},8,["onClick"]),R(i,{onClick:e.handleClose},{default:j((()=>[H])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","label-col","wrapper-col"])):I("",!0)])),_:1},8,["title","visible","onClose"])])};export default q;
